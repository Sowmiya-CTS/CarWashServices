package MiniProject;

import java.io.*;
import org.apache.poi.xssf.usermodel.*;
import java.util.*;

public class ExcelReader {

		public static String[] getTestData(String filePath,String sheetName) {
			try {
				FileInputStream file=new FileInputStream(new File(filePath));
				XSSFWorkbook workbook= new XSSFWorkbook();
				XSSFSheet sheet=workbook.createSheet(sheetName);
				
				int row=sheet.getLastRowNum();
				int col=sheet.getRow(0).getLastCellNum();
				
				String[][] data=new String[row][1];
				
				for(int i=0;i<row;i++) {
					HashMap<String,String> map=new HashMap<>();
					XSSFRow rows=sheet.getRow(i);
					
					for(int j=0;j<row;j++) {
						String key=sheet.getRow(0).getCell(j).getStringCellValue();
						String value=rows.getCell(j).getStringCellValue();
						map.put(key,value);
					}
					data[i-1][0]=map;
				}
				return data;	
			}catch(Exception e) {
				throw new Exception("Error reading excel file"+e.getMessage());
			}
		}
}
